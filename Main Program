#include <LiquidCrystal_I2C.h>
#include <SoftwareSerial.h>
SoftwareSerial komunikasi(14, 12); //RX dan TX
LiquidCrystal_I2C lcd(0x27, 16, 2); //menggunakan LCD 16x2
//variabel nilai millis
long millisSebelum;
int milidetik, detik, menit, jam;
//debounce
int currentState1 = HIGH;
int lastState1 = HIGH;
//sensor
int sensor1 = 16;
//variabel state
int state = 0;
int stateSensor = 0;
int flag = 0;
void setup() {
  //inisialisasi pinMode
  pinMode(sensor1, INPUT);
  //serial & LCD
  Serial.begin(9600);
  komunikasi.begin(9600);
  lcd.init();
  lcd.backlight();
  lcd.setCursor(1, 0);
  lcd.print("LIGHT MOVEMENT");
  lcd.setCursor(6, 1);
  lcd.print("JAR");
  delay(3000);
  lcd.clear();
}
void loop() {
  lcd.setCursor(3, 0);
  lcd.print("STOPWATCH");
  currentState1 = digitalRead(sensor1);
  if (lastState1 == HIGH && currentState1 == LOW) {
    flag++;
  }
  lastState1 = currentState1;
  if(flag == 1) {
    if(millis() >= millisSebelum + 100){
    milidetik++;
    if(milidetik >=10){
      milidetik=0;
      detik++;

    if(detik>=60){
      detik=0;
      menit++;
      }
    }
    lcd.clear();
    lcd.setCursor(9, 1);
    lcd.print(milidetik);
    lcd.setCursor(8, 1);
    lcd.print(":");
    lcd.setCursor(6, 1);
    lcd.print(detik);
    lcd.setCursor(4, 1);
    lcd.print(":");
    lcd.setCursor(3, 1);
    lcd.print(menit);
    millisSebelum=millis();
  }
  } else if (flag == 2) {
    lcd.clear();
    lcd.setCursor(3, 0);
    lcd.print("STOPWATCH");
     lcd.setCursor(9, 1);
    lcd.print(milidetik);
    lcd.setCursor(8, 1);
    lcd.print(":");
    lcd.setCursor(6, 1);
    lcd.print(detik);
    lcd.setCursor(4, 1);
    lcd.print(":");
    lcd.setCursor(3, 1);
    lcd.print(menit);
    flag = 0;
    delay(2000);
  }
  /*
    Serial.println(state);
    if(komunikasi.available() > 0){
      state=komunikasi.read();
       lcd.setCursor(1, 0);
       lcd.print("Pembacaan Data");
       lcd.setCursor(6, 1);
       lcd.print(state);
       Serial.println(state);
    }
    delay(500);
    lcd.clear();
  */
}
